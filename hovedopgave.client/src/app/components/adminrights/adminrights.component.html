<div class="container mx-auto p-4">
  <div class="main-container flex flex-col md:flex-row gap-4">
    <!-- Search Users Section -->
    <div class="section-container bg-white p-4 rounded-lg shadow-md w-full md:w-1/2">
      <h2 class="text-xl font-semibold mb-4">Search users</h2>
      <input id="search-users-input" type="text" placeholder="Search users..." [(ngModel)]="searchQuery" (input)="searchUser()" class="input input-bordered w-full mb-4" />
      <div class="user-list">
        <div *ngIf="searchQuery.trim() !== ''">
          <div class="user flex justify-between items-center p-2 border rounded mb-2" *ngFor="let user of searchResult; let i = index">
            <span class="user-display-name">{{ user.displayName }}</span>
            <span class="user-role text-gray-500">{{ user.role }}</span>
            <button (click)="openEditModal(user)" class="btn btn-primary">Edit</button>
          </div>
          <div *ngIf="!searchResult.length">
            <span>No user found with display name "{{ searchQuery }}"</span>
          </div>
          <div class="pagination-controls flex justify-center mt-4">
            <div class="join grid grid-cols-2 gap-4">
              <button id="previous-page" class="join-item btn btn-outline" (click)="previousPage()" [disabled]="currentPage === 1">Previous</button>
              <button id="next-page" class="join-item btn btn-outline" (click)="nextPage()">Next</button>
            </div>
          </div>
        </div>
      </div>

      <!-- List of Current Admins Section -->
      <div class="bg-base-100 p-4 rounded-lg shadow-md w-full md:w-1/2">
        <h2 class="text-xl font-semibold mb-4 text-center">List of Current Admins</h2>
        <div class="flex flex-col gap-2 border border-base-300 p-2 bg-base-100">
          <div class="flex items-center p-2 border rounded mb-2"
               *ngFor="let admin of admins">
            <span class="flex-1">{{ admin.displayName }}</span>
            <span class="w-32 text-gray-500 text-right">{{ admin.role }}</span>
            <button (click)="openEditModal(admin)"
                    class="btn btn-custom text-neutral-content ml-2">
              Edit
            </button>
          </div>
        </div>
      </div>

    <!-- Modal Section -->
    <div id="admin-modal" class="modal fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center" [class.active]="isModalOpen">
      <div class="modal-content bg-white p-6 rounded-lg shadow-lg w-full max-w-lg">
        <button class="close-modal absolute top-2 right-2 text-xl" (click)="closeModal()">Ã—</button>
        <div class="modal-header text-center text-xl font-semibold mb-4">
          Editing {{ selectedUser?.displayName }}
        </div>
        <div class="modal-body-footer-container flex flex-col md:flex-row gap-4">
          <div class="modal-body flex-1">
            <p class="font-semibold mb-2">Privileges</p>
            <div class="privileges flex flex-col gap-2">
              <div class="privilege-item p-2 border rounded cursor-pointer" [class.selected]="selectedRole === 'SYSTEMADMIN'" [class.current]="selectedUser?.role === 'SYSTEMADMIN'" (click)="changeUsersRole('SYSTEMADMIN')">SYSTEMADMIN</div>
              <div class="privilege-item p-2 border rounded cursor-pointer" [class.selected]="selectedRole === 'SUPERUSER'" [class.current]="selectedUser?.role === 'SUPERUSER'" (click)="changeUsersRole('SUPERUSER')">SUPERUSER</div>
              <div class="privilege-item p-2 border rounded cursor-pointer" [class.selected]="selectedRole === 'MODERATOR'" [class.current]="selectedUser?.role === 'MODERATOR'" (click)="changeUsersRole('MODERATOR')">MODERATOR</div>
              <div class="privilege-item p-2 border rounded cursor-pointer" [class.selected]="selectedRole === 'CREATOR'" [class.current]="selectedUser?.role === 'CREATOR'" (click)="changeUsersRole('CREATOR')">CREATOR</div>
              <div class="privilege-item p-2 border rounded cursor-pointer" [class.selected]="selectedRole === 'AFFILIATE'" [class.current]="selectedUser?.role === 'AFFILIATE'" (click)="changeUsersRole('AFFILIATE')">AFFILIATE</div>
              <div class="privilege-item p-2 border rounded cursor-pointer" [class.selected]="selectedRole === 'USER'" [class.current]="selectedUser?.role === 'USER'" (click)="changeUsersRole('USER')">USER</div>
              <div class="privilege-item p-2 border rounded cursor-pointer" [class.selected]="selectedRole === 'GUEST'" [class.current]="selectedUser?.role === 'GUEST'" (click)="changeUsersRole('GUEST')">GUEST</div>
            </div>
          </div>
          <div class="modal-footer flex-1">
            <p class="font-semibold mb-2">Change Display Name</p>
            <div class="display-name-container flex gap-2">
              <input type="text" [(ngModel)]="newDisplayName" placeholder="New display name" class="input input-bordered w-full" id="update-display-name-input"/>
              <button class="update-display-name btn btn-success" (click)="changeUsersDisplayName()" id="update-display-name-button">Update</button>
            </div>
          </div>
        </div>
        <div class="modal-actions flex justify-between mt-4">
          <button id="delete-user-button" class="delete-user btn btn-error" (click)="deleteUser()">Delete User</button>
          <button class="send-password btn btn-primary" (click)="sendNewPassword()">Reset password</button>
        </div>
      </div>
    </div>
  </div>
</div>
